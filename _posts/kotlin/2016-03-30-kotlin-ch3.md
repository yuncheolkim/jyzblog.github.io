---
layout: post
title: kotlin第3章 函数和lambda表达式
tags: [kotlin, pl]
categories: 编程语言
---

### 函数定义

函数的基本定义如下

```java
private fun function(x:Int):Int{
    return 1
}
```

如果没有定义 `private` 则默认为 `public` .
即使没有类,函数也可以直接写在kotlin文件里面，这时候这些函数直接被转化为 `java` 中对应的静态函数。
上面定义了一个参数为 `int` 返回值也是一个 `int` 的函数,和前面说的定义变量规则是一样。

### 函数作用域

函数内部可以定义函数

```java
private fun function(x:Int){
    val set = hashSetOf<Int>()
    fun function(){
        set.add(1)
    }

    function()
}
```

内部函数可以访问外部函数内的局部变量，这里的内部 function 访问外部的 set

### 返回值

因为函数可以内部嵌套，所以可以使外部函数从内部函数返回，不继续执行外部函数其余的操作。

```java
fun returnTest(){
    val intList = arrayOf(1,2,3,4)
    intList.forEach {
        if(it == 2)return
        println(it)
    }

    println("end")
}
```

在这里最后不会打印end，这里forEach的参数一个lambda表达式(必须是 inline 标记的函数)。
如果我们想要只是想从forEach返回，则需要标记来帮助，如：

```java
fun returnTest(){
    val intList = arrayOf(1,2,3,4)
    intList.forEach li@{
        if(it == 2)return@li
        println(it)
    }
    println("end")
}
```

这样，最后的 end 会打出来。这里的 li 可以忽略，这事 forEach 会成为默认标记，如：

```java
fun returnTest(){
    val intList = arrayOf(1,2,3,4)
    intList.forEach {
        if(it == 2)return@forEach
        println(it)
    }
    println("end")
}
```

这里我们可以用匿名函数作为 forEach 的参数这样就可以省略了 return 后面的标签，如下：

```java
fun returnTest(){
    val intList = arrayOf(1,2,3,4)
    intList.forEach(fun(value:Int){
       if(value == 2)return
       print(value)
    })
    println("end")
}
```

这里 return 只是从匿名函数中返回。
如果有返回值则用下面的表达式返回。

```java
fun returnTest() {
    run {
        return@run 22
    }

    println("end")
}

inline fun run(action: () -> Int) {
    val a = action()
    println(a)
}
```

### infix

函数可以用 infix 标识，用来使用标记法调用函数。
infix 标识的函数要满足以下条件：

* 成员函数，或者扩展函数
* 有且只有一个参数

```java
// Define extension to Int
infix fun Int.shl(x: Int): Int { ...

}
// call extension function using infix notation
1 shl 2
// is the same as
1.shl(2)
```















1
